graph LR
    A[User Browser] --> B[Cloudflare Access]
    B --> C{Authenticated?}
    C -->|No| D[Identity Provider<br/>SSO/OAuth]
    D --> E[User Login]
    E --> F[Auth Token]
    F --> B
    C -->|Yes| G[Policy Engine]
    G --> H{Policy Check}
    H -->|Allow| I[Cloudflare Tunnel]
    H -->|Deny| J[Access Denied]
    I --> K[Private Application<br/>Never exposed to internet]
    
    style A fill:#e1f5fe
    style B fill:#f3e5f5
    style G fill:#fff3e0
    style K fill:#e8f5e8
    style J fill:#ffebee